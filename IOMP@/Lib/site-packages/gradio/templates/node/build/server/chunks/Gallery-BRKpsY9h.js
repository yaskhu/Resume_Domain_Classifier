import './async-DWBXLqlH.js';
import { c as bind_props, d as attr_class, g as attr_style, j as stringify, e as ensure_array_like, a as attr } from './index-D1re1cuM.js';
import './MarkdownCode.svelte_svelte_type_style_lang-A-Es8TiR.js';
import { k } from './BlockLabel-B2_AkSr2.js';
import { w } from './IconButton-C2_XRZp7.js';
import { p } from './Empty-Cuu1wIXQ.js';
import { y as y$1 } from './ShareButton-CbQ-RhXX.js';
import { o } from './Clear-CTfKb9Id.js';
import { l } from './Download-DQCZIsve.js';
import { i } from './Image2-BjKIvzAW.js';
import { h, e } from './Upload-CBOKnugH.js';
import { n } from './Play-Cq5X6dSn.js';
import { r } from './Video-BJvaeIU2.js';
import { h as h$1 } from './Webcam-yHK4vsGx.js';
import { y } from './IconButtonWrapper-BI5v6wo4.js';
import { v } from './FullscreenButton-aHuwUXcu.js';
import { I as Ie } from './2-C3I2NxUJ.js';
import { e as ee } from './Upload2-Ccw9-6U9.js';
import { z } from './ModifyUpload-60J1ecV0.js';
import { c } from './Image-Dl2g0mq0.js';
import { c as ch } from './Video2-BN0RGMYm.js';
import { O } from './utils.svelte-Cx-zzaP-.js';
import { e as escape_html } from './escaping-CBnpiEl5.js';
import './context-BZS6UlnY.js';
import './uneval-ZBzcyJ66.js';
import './clone-CubQhOZi.js';
import './prism-python-BGHJcX3U.js';
import './index-server-D4bj_1UO.js';
import './Maximize-DWTTqpgt.js';
import './index5-BoOEKc6P.js';
import './dev-fallback-Bc5Ork7Y.js';
import './DownloadLink-YXQWXYPr.js';
import './Edit-DnE7yQ6U.js';
import './Undo-BWigpY9w.js';

async function rt(h){return h?`<div style="display: flex; flex-wrap: wrap; gap: 16px">${(await Promise.all(h.map(async([c,g])=>c===null||!c.url?"":await O(c.url)))).map(c=>`<img src="${c}" style="height: 400px" />`).join("")}</div>`:""}async function al(h,v,c="uploaded_file"){const g=h.type.split("/")[1]||"png",f=new File([h],`${c}.${g}`),m=[new Ie({path:f.name,orig_name:f.name,blob:f,size:f.size,mime_type:f.type,is_stream:false})];return await v(...m)}function xt(h$2,v$1){h$2.component(c$1=>{let{show_label:g=true,label:f,value:m=void 0,columns:O=[2],rows:R=void 0,height:d="auto",preview:S,allow_preview:V=true,object_fit:C="cover",show_share_button:W=false,show_download_button:A=false,i18n:_,selected_index:p$1=void 0,interactive:E,_fetch:H,show_fullscreen_button:q=true,fullscreen:J=false,root:K="",file_types:N=["image","video"],sources:k$1,max_file_size:Q=null,upload:L,stream_handler:P,fit_columns:X=true,buttons:Y=null,oncustom_button_click:Z=null,onpreview_open:Ut=()=>{},onchange:jt=()=>{},onclear:$=()=>{},onselect:Et=t=>{},onshare:Lt=t=>{},onerror:tt=t=>{},onpreview_close:lt=()=>{},onfullscreen:at=t=>{},ondelete:Pt=()=>{},onupload:it=()=>{},onsource_change:y$2=()=>{}}=v$1,B=null,I="normal",ot=false,r$1=false,u=m==null?null:m.map(t=>"video"in t?{video:t.video,caption:t.caption}:"image"in t?{image:t.image,caption:t.caption}:{});function st(t,n,a){if(t&&n&&a){const l=t.length;return Array.isArray(n)?n.map(i=>Math.min(i,l)):Math.min(n,l)}else return n}let ut=st(u,O,X);p$1==null&&S&&m?.length&&(p$1=0),((p$1??0)+(u?.length??0)-1)%(u?.length??0),((p$1??0)+1)%(u?.length??0);async function nt(t,n){let a;try{a=await H(t);}catch(z){if(z instanceof TypeError){window.open(t,"_blank","noreferrer");return}throw z}const l=await a.blob(),i=URL.createObjectURL(l),e=document.createElement("a");e.href=i,e.download=n,e.click(),URL.revokeObjectURL(i);}let s$1=p$1!=null&&u!=null?u[p$1]:null;let M=false,w$1=true,x;function et(t){if(g?(t.push("<!--[-->"),k(t,{show_label:g,Icon:i,label:f||"Gallery"})):t.push("<!--[!-->"),t.push("<!--]--> "),m==null||u==null||u.length===0)t.push("<!--[-->"),p(t,{unpadded_box:true,size:"large",children:n=>{i(n);},$$slots:{default:true}});else {if(t.push("<!--[!-->"),t.push('<div class="gallery-container">'),s$1&&V){t.push("<!--[-->"),t.push(`<span${attr_class("preview svelte-7anmrz",void 0,{minimal:I==="minimal"})}>`),y(t,{display_top_corner:ot,buttons:Y,on_custom_button_click:Z,children:l$1=>{A?(l$1.push("<!--[-->"),w(l$1,{Icon:l,label:_("common.download"),onclick:()=>{const i="image"in s$1?s$1?.image:s$1?.video;if(i==null)return;const{url:e,orig_name:z}=i;e&&nt(e,z??"image");}})):l$1.push("<!--[!-->"),l$1.push("<!--]--> "),q?(l$1.push("<!--[-->"),v(l$1,{fullscreen:J,onclick:i=>at({detail:i})})):l$1.push("<!--[!-->"),l$1.push("<!--]--> "),W?(l$1.push("<!--[-->"),l$1.push('<div class="icon-button">'),y$1(l$1,{i18n:_,value:u,formatter:rt}),l$1.push("<!----></div>")):l$1.push("<!--[!-->"),l$1.push("<!--]--> "),(l$1.push("<!--[-->"),w(l$1,{Icon:o,label:"Close",onclick:()=>{p$1=null,lt();}})),l$1.push("<!--]-->");}}),t.push(`<!----> <button class="media-button svelte-7anmrz"${attr_style(`height: calc(100% - ${stringify(s$1.caption?"80px":"60px")})`)} aria-label="detailed view of selected image">`),"image"in s$1?(t.push("<!--[-->"),c(t,{restProps:{alt:s$1.caption||"",title:s$1.caption||null,class:s$1.caption&&"with-caption",loading:"lazy"},src:s$1.image.url,data_testid:"detailed-image"})):(t.push("<!--[!-->"),ch(t,{src:s$1.video.url,"data-testid":"detailed-video",alt:s$1.caption||"",loading:"lazy",loop:false,is_stream:false,muted:false,controls:true})),t.push("<!--]--></button> "),s$1?.caption?(t.push("<!--[-->"),t.push(`<caption class="caption svelte-7anmrz">${escape_html(s$1.caption)}</caption>`)):t.push("<!--[!-->"),t.push(`<!--]--> <div class="thumbnails scroll-hide svelte-7anmrz" data-testid="container_el"${attr_style(`justify-content: ${stringify("center")};`)}><!--[-->`);const a=ensure_array_like(u);for(let l=0,i=a.length;l<i;l++){let e=a[l];t.push(`<button${attr_class("thumbnail-item thumbnail-small svelte-7anmrz",void 0,{selected:p$1===l&&I!=="minimal"})}${attr("aria-label","Thumbnail "+(l+1)+" of "+u.length)}>`),"image"in e?(t.push("<!--[-->"),c(t,{src:e.image.url,restProps:{title:e.caption||null,alt:"",class:"with-caption",loading:"lazy"},data_testid:`thumbnail ${l+1}`})):(t.push("<!--[!-->"),n(t),t.push("<!----> "),ch(t,{src:e.video.url,title:e.caption||null,is_stream:false,"data-testid":"thumbnail "+(l+1),alt:"",loading:"lazy",loop:false}),t.push("<!---->")),t.push("<!--]--></button>");}t.push("<!--]--></div></span>");}else t.push("<!--[!-->");t.push(`<!--]--> <div${attr_class("grid-wrap svelte-7anmrz",void 0,{minimal:I==="minimal","fixed-height":!d||d=="auto",hidden:r$1})}${attr_style("",{height:d!=="auto"?d+"px":null})}>`),E&&p$1===null?(t.push("<!--[-->"),z(t,{i18n:_,onclear:()=>{m=[],y$2("upload"),$();},children:a=>{L&&P?(a.push("<!--[-->"),w(a,{Icon:h,label:_("upload_text.click_to_upload"),children:l=>{ee(l,{icon_upload:true,onload:i=>it(i),filetype:N,file_count:"multiple",max_file_size:Q,root:K,onerror:i=>tt(i),stream_handler:P,upload:L,get upload_promise(){return B},set upload_promise(i){B=i,w$1=false;},get uploading(){return M},set uploading(i){M=i,w$1=false;}});}})):a.push("<!--[!-->"),a.push("<!--]--> "),k$1.includes("webcam")?(a.push("<!--[-->"),w(a,{Icon:h$1,label:_("common.webcam"),onclick:()=>{y$2("webcam");}})):a.push("<!--[!-->"),a.push("<!--]--> "),k$1.includes("webcam-video")?(a.push("<!--[-->"),w(a,{Icon:r,label:_("common.video"),onclick:()=>{y$2("webcam-video");}})):a.push("<!--[!-->"),a.push("<!--]--> "),k$1.includes("clipboard")?(a.push("<!--[-->"),w(a,{label:_("upload_text.paste_clipboard"),onclick:()=>{y$2("clipboard");},Icon:e})):a.push("<!--[!-->"),a.push("<!--]-->");}})):t.push("<!--[!-->"),t.push(`<!--]--> <div${attr_class("grid-container svelte-7anmrz",void 0,{"pt-6":g})}${attr_style(`--grid-cols:${stringify(ut)}; --grid-rows:${stringify(R)}; --object-fit: ${stringify(C)};`)}><!--[-->`);const n$1=ensure_array_like(u);for(let a=0,l=n$1.length;a<l;a++){let i=n$1[a];t.push(`<div class="gallery-item svelte-7anmrz"><button${attr_class("thumbnail-item thumbnail-lg svelte-7anmrz",void 0,{selected:p$1===a})}${attr("aria-label","Thumbnail "+(a+1)+" of "+u.length)}>`),"image"in i?(t.push("<!--[-->"),c(t,{alt:i.caption||"",src:typeof i.image=="string"?i.image:i.image.url})):(t.push("<!--[!-->"),n(t),t.push("<!----> "),ch(t,{src:i.video.url,title:i.caption||null,is_stream:false,"data-testid":"thumbnail "+(a+1),alt:"",loading:"lazy",loop:false}),t.push("<!---->")),t.push("<!--]--> "),i.caption?(t.push("<!--[-->"),t.push(`<div class="caption-label svelte-7anmrz">${escape_html(i.caption)}</div>`)):t.push("<!--[!-->"),t.push("<!--]--></button> "),E?(t.push("<!--[-->"),t.push('<button class="delete-button svelte-7anmrz" aria-label="Delete image">'),o(t),t.push("<!----></button>")):t.push("<!--[!-->"),t.push("<!--]--></div>");}t.push("<!--]--></div></div></div>");}t.push("<!--]-->");}do w$1=true,x=c$1.copy(),et(x);while(!w$1);c$1.subsume(x),bind_props(v$1,{value:m,selected_index:p$1});});}const il=Object.freeze(Object.defineProperty({__proto__:null,default:xt},Symbol.toStringTag,{value:"Module"}));

export { xt as G, il as a, al as h };
//# sourceMappingURL=Gallery-BRKpsY9h.js.map
