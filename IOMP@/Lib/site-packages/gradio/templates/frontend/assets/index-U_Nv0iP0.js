const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./module-C85Cvh0Z.js","./module-DoWOc2fJ.js","./module-B5lWqP2v.js"])))=>i.map(i=>d[i]);
import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import{onMount as de,onDestroy as Se,tick as ze}from"./svelte/svelte_svelte.js";import"./i18n-IeFj-zpk.js";import{f as le,u as Te,G as We}from"./utils.svelte-NGrRZh7a.js";import{a as qe,S as ke}from"./StreamingBar-CdRfiLdf.js";import{W as Oe,A as Ge,S as He}from"./StaticAudio-CsdouK6v.js";import{M as Re,U as Ne}from"./ModifyUpload-p1twvKjm.js";import{_ as Ae,p as Fe}from"./index-VELz1aW8.js";import{_ as Ve,Q as Ke,d as Qe,K as Ye,S as Je,a6 as Xe,B as Pe,U as Ze}from"./ScrollFade-YiJdnYV-.js";import{S as $e}from"./ShareButton-CzqLPjdz.js";import{s as De,u as we,p as Be}from"./MinimalAudioPlayer-pesaxg4B.js";import{o as ye}from"./record.esm-EHLfhwCm.js";import"./svelte/svelte_internal_flags_legacy.js";import{default as ir}from"./Example-COthpgua.js";import"./svelte/svelte_store.js";import"./svelte/svelte_motion.js";import"./MarkdownCode-DtcflbAZ.js";import"./prism-python-BAjd7o3F.js";import"./svelte/svelte_transition.js";import"./VolumeLevels-CnHXisKY.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_events.js";var et=e.from_html("<option> </option>"),tt=e.from_html("<option> </option>"),rt=e.from_html('<select class="mic-select svelte-ym1wxn" aria-label="Select input device"><!></select>');function Me(q,t){e.push(t,!0);let i=e.prop(t,"micDevices",15);de(()=>{if(typeof window<"u"&&navigator.mediaDevices){let l=[];ye.getAvailableAudioDevices().then(a=>{i(a),a.forEach(n=>{n.deviceId&&l.push(n)}),i(l)}).catch(a=>{a instanceof DOMException&&a.name=="NotAllowedError"&&t.onerror?.(t.i18n("audio.allow_recording_access"))})}});var g=rt(),W=e.child(g);{var r=l=>{var a=et(),n=e.child(a,!0);e.reset(a),a.value=a.__value="",e.template_effect(y=>e.set_text(n,y),[()=>t.i18n("audio.no_microphone")]),e.append(l,a)},b=l=>{var a=e.comment(),n=e.first_child(a);e.each(n,17,i,e.index,(y,u)=>{var m=tt(),R=e.child(m,!0);e.reset(m);var D={};e.template_effect(()=>{e.set_text(R,e.get(u).label),D!==(D=e.get(u).deviceId)&&(m.value=(m.__value=e.get(u).deviceId)??"")}),e.append(y,m)}),e.append(l,a)};e.if(W,l=>{!i()||i().length===0?l(r):l(b,!1)})}e.reset(g),e.template_effect(()=>g.disabled=!i()||i().length===0),e.append(q,g),e.pop()}var at=e.from_html('<time class="duration-button duration svelte-1xuh0j1"> </time>'),it=e.from_html('<div class="controls svelte-1xuh0j1"><div class="wrapper svelte-1xuh0j1"><button class="record record-button svelte-1xuh0j1"> </button> <button> </button> <button id="stop-paused" class="stop-button-paused svelte-1xuh0j1"> </button> <button aria-label="pause" class="pause-button svelte-1xuh0j1"><!></button> <button class="resume-button svelte-1xuh0j1"> </button> <!></div> <!></div>');function ot(q,t){e.push(t,!0);let i=e.prop(t,"recording",3,!1),g=e.prop(t,"timing",3,!1),W=e.state(e.proxy([])),r,b,l,a,n,y=e.state(!1);const u=()=>{r.style.display="none",a.style.display="flex",b.style.display="block"},m=()=>{t.record.isPaused()&&(t.record.resumeRecording(),t.record.stopRecording()),t.record.stopMic(),r.style.display="flex",a.style.display="none",b.style.display="none",r.disabled=!1},R=()=>{b.style.display="none",l.style.display="block",a.style.display="none",n.style.display="flex"},D=()=>{b.style.display="block",l.style.display="none",r.style.display="none",a.style.display="flex",n.style.display="none"};de(()=>{t.record.on("record-start",u),t.record.on("record-end",m),t.record.on("record-pause",R),t.record.on("record-resume",D)}),Se(()=>{t.record.un("record-start",u),t.record.un("record-end",m),t.record.un("record-pause",R),t.record.un("record-resume",D)}),e.user_effect(()=>{i()&&!e.get(y)?t.record.startMic().then(()=>{t.record.startRecording(),e.set(y,!0)}):!i()&&e.get(y)&&(t.record.isPaused()&&t.record.resumeRecording(),t.record.stopRecording(),e.set(y,!1))});var C=it(),I=e.child(C),j=e.child(I);j.__click=()=>t.record.startRecording();var L=e.child(j,!0);e.reset(j),e.bind_this(j,_=>r=_,()=>r);var s=e.sibling(j,2);s.__click=()=>{t.record.isPaused()&&(t.record.resumeRecording(),t.record.stopRecording()),t.record.stopRecording()};var k=e.child(s,!0);e.reset(s),e.bind_this(s,_=>a=_,()=>a);var A=e.sibling(s,2);A.__click=()=>{t.record.isPaused()&&(t.record.resumeRecording(),t.record.stopRecording()),t.record.stopRecording()};var O=e.child(A,!0);e.reset(A),e.bind_this(A,_=>n=_,()=>n);var w=e.sibling(A,2);w.__click=()=>t.record.pauseRecording();var B=e.child(w);Ve(B),e.reset(w),e.bind_this(w,_=>b=_,()=>b);var f=e.sibling(w,2);f.__click=()=>t.record.resumeRecording();var v=e.child(f,!0);e.reset(f),e.bind_this(f,_=>l=_,()=>l);var x=e.sibling(f,2);{var E=_=>{var P=at(),G=e.child(P,!0);e.reset(P),e.template_effect(()=>e.set_text(G,t.record_time)),e.append(_,P)};e.if(x,_=>{g()&&!t.show_recording_waveform&&_(E)})}e.reset(I);var M=e.sibling(I,2);Me(M,{get i18n(){return t.i18n},get micDevices(){return e.get(W)},set micDevices(_){e.set(W,_,!0)}}),e.reset(C),e.template_effect((_,P,G,d,F)=>{e.set_text(L,_),e.set_class(s,1,`stop-button ${P??""}`,"svelte-1xuh0j1"),e.set_text(k,G),e.set_text(O,d),e.set_text(v,F)},[()=>t.i18n("audio.record"),()=>t.record.isPaused()?"stop-button-paused":"",()=>t.i18n("audio.stop"),()=>t.i18n("audio.stop"),()=>t.i18n("audio.resume")]),e.append(q,C),e.pop()}e.delegate(["click"]);var nt=e.from_html('<time class="trim-duration svelte-j9q3sk"> </time>'),st=e.from_html('<time class="duration svelte-j9q3sk"> </time>'),lt=e.from_html('<time class="duration svelte-j9q3sk">0:00</time>'),dt=e.from_html('<div class="timestamps svelte-j9q3sk"><time class="time svelte-j9q3sk">0:00</time> <div><!> <!></div></div>'),ct=e.from_html('<div class="component-wrapper svelte-j9q3sk"><div class="microphone svelte-j9q3sk" data-testid="microphone-waveform"></div> <div data-testid="recording-waveform"></div> <!> <!> <!></div>');function ut(q,t){e.push(t,!0);let i=e.prop(t,"mode",15),g=e.prop(t,"waveform_options",19,()=>({show_recording_waveform:!0})),W=e.prop(t,"editable",3,!0),r=e.prop(t,"recording",3,!1),b,l=e.state(void 0),a=e.state(!1),n,y,u=e.state(void 0),m=e.state(null),R,D,C=e.state(0),I=e.state(0),j,L=e.state(!1),s=e.state(0),k=e.state(!1);const A=()=>{clearInterval(j),j=setInterval(()=>{e.update(I)},1e3)};function O(){if(A(),e.set(L,!0),t.onstartrecording?.(),g().show_recording_waveform){let o=y;o&&(o.style.display="block")}}async function w(o){e.set(I,0),e.set(L,!1),clearInterval(j);try{const p=await o.arrayBuffer(),V=await new AudioContext({sampleRate:t.waveform_settings.sampleRate}).decodeAudioData(p);V&&await Be(V).then(async K=>{await t.dispatch_blob([K],"change"),await t.dispatch_blob([K],"stop_recording")})}catch(p){console.error(p)}}e.user_effect(()=>{e.get(u)?.on("record-resume",()=>{A()})}),e.user_effect(()=>{e.get(l)?.on("decode",o=>{e.set(C,o,!0),D&&(D.textContent=le(o))})}),e.user_effect(()=>{e.get(l)?.on("timeupdate",o=>R&&(R.textContent=le(o)))}),e.user_effect(()=>{e.get(l)?.on("pause",()=>{t.onpause?.(),e.set(a,!1)})}),e.user_effect(()=>{e.get(l)?.on("play",()=>{t.onplay?.(),e.set(a,!0)})}),e.user_effect(()=>{e.get(l)?.on("finish",()=>{t.onstop?.(),e.set(a,!1)})});const B=()=>{y&&(y.innerHTML=""),b!==void 0&&b.destroy(),y&&(b=we.create({...t.waveform_settings,normalize:!1,container:y}),e.set(u,b.registerPlugin(ye.create()),!0),e.get(u)?.on("record-end",w),e.get(u)?.on("record-start",O),e.get(u)?.on("record-pause",()=>{t.onpauserecording?.(),clearInterval(j)}),e.get(u)?.on("record-end",o=>{e.set(m,URL.createObjectURL(o),!0);const p=y,H=n;p&&(p.style.display="none"),H&&e.get(m)&&(H.innerHTML="",f())}),e.set(k,!0))},f=()=>{let o=n;!e.get(m)||!o||e.set(l,we.create({container:o,url:e.get(m),...t.waveform_settings}),!0)},v=async(o,p)=>{i("edit");const H=e.get(l)?.getDecodedData();H&&await Be(H,o,p).then(async V=>{await t.dispatch_blob([V],"change"),await t.dispatch_blob([V],"stop_recording"),e.get(l)?.destroy(),f()}),t.onedit?.()};de(()=>{B(),window.addEventListener("keydown",o=>{n&&n.contains(document.activeElement)&&(o.key==="ArrowRight"?De(e.get(l),.1):o.key==="ArrowLeft"&&De(e.get(l),-.1))})});var x=ct(),E=e.child(x);e.bind_this(E,o=>y=o,()=>y);var M=e.sibling(E,2);e.bind_this(M,o=>n=o,()=>n);var _=e.sibling(M,2);{var P=o=>{var p=dt(),H=e.child(p);e.bind_this(H,U=>R=U,()=>R);var V=e.sibling(H,2),K=e.child(V);{var ae=U=>{var z=nt(),Q=e.child(z,!0);e.reset(z),e.template_effect($=>e.set_text(Q,$),[()=>le(e.get(s))]),e.append(U,z)};e.if(K,U=>{i()==="edit"&&e.get(s)>0&&U(ae)})}var ve=e.sibling(K,2);{var ce=U=>{var z=st(),Q=e.child(z,!0);e.reset(z),e.template_effect($=>e.set_text(Q,$),[()=>le(e.get(I))]),e.append(U,z)},ue=U=>{var z=lt();e.bind_this(z,Q=>D=Q,()=>D),e.append(U,z)};e.if(ve,U=>{e.get(L)?U(ce):U(ue,!1)})}e.reset(V),e.reset(p),e.append(o,p)};e.if(_,o=>{(e.get(L)||e.get(m))&&g().show_recording_waveform&&o(P)})}var G=e.sibling(_,2);{var d=o=>{{let p=e.derived(()=>le(e.get(I)));ot(o,{get record(){return e.get(u)},get i18n(){return t.i18n},get timing(){return e.get(L)},get recording(){return r()},get show_recording_waveform(){return g().show_recording_waveform},get record_time(){return e.get(p)}})}};e.if(G,o=>{e.get(k)&&!e.get(m)&&o(d)})}var F=e.sibling(G,2);{var xe=o=>{Oe(o,{get waveform(){return e.get(l)},get container(){return n},get playing(){return e.get(a)},get audio_duration(){return e.get(C)},get i18n(){return t.i18n},get editable(){return W()},interactive:!0,handle_trim_audio:v,show_redo:!0,get handle_reset_value(){return t.handle_reset_value},get waveform_options(){return g()},get trimDuration(){return e.get(s)},set trimDuration(p){e.set(s,p,!0)},get mode(){return i()},set mode(p){i(p)}})};e.if(F,o=>{e.get(l)&&e.get(m)&&o(xe)})}e.reset(x),e.append(q,x),e.pop()}var _t=e.from_html('<div class="svelte-m6ymia"></div>'),gt=e.from_html('<button><span class="record-icon svelte-m6ymia"><span class="pinger svelte-m6ymia"></span> <span class="dot svelte-m6ymia"></span></span> </button>'),mt=e.from_html('<button class="spinner-button svelte-m6ymia"><div class="icon svelte-m6ymia"><!></div> </button>'),ft=e.from_html('<button class="record-button svelte-m6ymia"><span class="record-icon svelte-m6ymia"><span class="dot svelte-m6ymia"></span></span> </button>'),vt=e.from_html('<div class="mic-wrap svelte-m6ymia"><!> <div class="controls svelte-m6ymia"><!> <!></div></div>');function pt(q,t){e.push(t,!0);let i=e.prop(t,"recording",3,!1),g=e.prop(t,"paused_recording",3,!1),W=e.prop(t,"waveform_options",19,()=>({show_recording_waveform:!0})),r=e.prop(t,"waiting",3,!1),b,l,a,n=e.state(e.proxy([]));de(()=>{y()});const y=()=>{b!==void 0&&b.destroy(),a&&(b=we.create({...t.waveform_settings,normalize:!1,container:a}),l=b.registerPlugin(ye.create()))};var u=vt(),m=e.child(u);{var R=s=>{var k=_t();let A;e.bind_this(k,O=>a=O,()=>a),e.template_effect(()=>A=e.set_style(k,"",A,{display:i()?"block":"none"})),e.append(s,k)};e.if(m,s=>{W().show_recording_waveform&&s(R)})}var D=e.sibling(m,2),C=e.child(D);{var I=s=>{var k=gt();k.__click=()=>{l?.stopMic(),t.stop()};var A=e.sibling(e.child(k));e.reset(k),e.template_effect(O=>{e.set_class(k,1,e.clsx(g()?"stop-button-paused":"stop-button"),"svelte-m6ymia"),e.set_text(A,` ${O??""}`)},[()=>g()?t.i18n("audio.pause"):t.i18n("audio.stop")]),e.append(s,k)},j=s=>{var k=e.comment(),A=e.first_child(k);{var O=B=>{var f=mt();f.__click=()=>{t.stop()};var v=e.child(f),x=e.child(v);Ke(x),e.reset(v);var E=e.sibling(v);e.reset(f),e.template_effect(M=>e.set_text(E,` ${M??""}`),[()=>t.i18n("audio.waiting")]),e.append(B,f)},w=B=>{var f=ft();f.__click=()=>{l?.startMic(),t.record()};var v=e.sibling(e.child(f));e.reset(f),e.template_effect(x=>e.set_text(v,` ${x??""}`),[()=>t.i18n("audio.record")]),e.append(B,f)};e.if(A,B=>{i()&&r()?B(O):B(w,!1)},!0)}e.append(s,k)};e.if(C,s=>{i()&&!r()?s(I):s(j,!1)})}var L=e.sibling(C,2);Me(L,{get i18n(){return t.i18n},get micDevices(){return e.get(n)},set micDevices(s){e.set(n,s,!0)}}),e.reset(D),e.reset(u),e.append(q,u),e.pop()}e.delegate(["click"]);let Ee;async function ht(){const{MediaRecorder:q,register:t}=await Ae(async()=>{const{MediaRecorder:g,register:W}=await import("./module-C85Cvh0Z.js");return{MediaRecorder:g,register:W}},__vite__mapDeps([0,1]),import.meta.url),{connect:i}=await Ae(async()=>{const{connect:g}=await import("./module-B5lWqP2v.js");return{connect:g}},__vite__mapDeps([2,1]),import.meta.url);return t(await i()),Ee=q,Ee}var bt=e.from_html("<!> <!>",1),wt=e.from_html("<!> <!>",1),yt=e.from_html("<!> <div><!> <!> <!></div>",1);function xt(q,t){e.push(t,!0);let i=e.prop(t,"value",15,null),g=e.prop(t,"subtitles",3,null),W=e.prop(t,"show_label",3,!0),r=e.prop(t,"buttons",19,()=>["download","share"]),b=e.prop(t,"on_custom_button_click",3,null),l=e.prop(t,"sources",19,()=>["microphone","upload"]),a=e.prop(t,"pending",3,!1),n=e.prop(t,"streaming",3,!1),y=e.prop(t,"trim_region_settings",19,()=>({})),u=e.prop(t,"waveform_options",19,()=>({})),m=e.prop(t,"dragging",15,!1),R=e.prop(t,"active_source",15,"microphone"),D=e.prop(t,"handle_reset_value",3,()=>{}),C=e.prop(t,"editable",3,!0),I=e.prop(t,"max_file_size",3,null),j=e.prop(t,"stream_every",3,.1),L=e.prop(t,"uploading",15,!1),s=e.prop(t,"recording",15,!1),k=e.prop(t,"class_name",3,""),A=e.prop(t,"upload_promise",15),O=e.prop(t,"initial_value",15),w=e.prop(t,"playback_position",15),B=e.prop(t,"time_limit",3,null),f=e.prop(t,"stream_state",3,"closed");e.user_effect(()=>{t.ondrag?.(m())});let v,x=e.state(""),E,M=[],_=!1,P=!1,G;const d=44;let F=[];typeof window<"u"&&n()&&ht().then(c=>{G=c});const o=c=>c.map(h=>h instanceof Blob?h:h.slice()),p=async(c,h)=>{let N=new File(o(c),"audio.wav",{type:"audio/wav"});if(N.size===0)return;const Y=await Fe([N],h==="stream");O(i()),i((await t.upload(Y,t.root,void 0,I()||void 0))?.filter(Boolean)[0]),h==="stream"?t.onstream?.(i()):h==="change"?t.onchange?.(i()):h==="stop_recording"&&t.onstop_recording?.()};Se(()=>{n()&&v&&v.state!=="inactive"&&v.stop()});async function H(){let c;try{c=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(h){if(!navigator.mediaDevices){t.onerror?.(t.i18n("audio.no_device_support"));return}if(h instanceof DOMException&&h.name=="NotAllowedError"){t.onerror?.(t.i18n("audio.allow_recording_access"));return}throw h}c!=null&&(n()?(v=new G(c,{mimeType:"audio/wav"}),v.addEventListener("dataavailable",V)):(v=new MediaRecorder(c),v.addEventListener("dataavailable",h=>{F.push(h.data)})),v.addEventListener("stop",async()=>{s(!1),v.stop(),await p(F,"change"),await p(F,"stop_recording"),F=[]}),P=!0)}async function V(c){let h=await c.data.arrayBuffer(),N=new Uint8Array(h);if(E||(E=new Uint8Array(h.slice(0,d)),N=new Uint8Array(h.slice(d))),a())M.push(N);else{let Y=[E].concat(M,[N]);if(!s()||f()==="waiting")return;p(Y,"stream"),M=[]}}e.user_effect(()=>{if(_&&a()===!1&&(_=!1,E&&M)){let c=[E].concat(M);M=[],p(c,"stream")}});async function K(){s(!0),t.onstart_recording?.(),P||await H(),E=void 0,n()&&v.state!="recording"&&v.start(j()*1e3)}function ae(){t.onchange?.(null),t.onclear?.(),e.set(x,""),i(null)}function ve(c){i(c),t.onchange?.(c),t.onupload?.(c)}async function ce(){s(!1),n()&&(t.onclose_stream?.(),t.onstop_recording?.(),v.stop(),a()&&(_=!0),await p(F,"stop_recording"),t.onclear?.(),e.set(x,""))}e.user_effect(()=>{!s()&&v&&e.get(x)!==""&&ce()}),e.user_effect(()=>{s()&&v&&K()});var ue=yt(),U=e.first_child(ue);{let c=e.derived(()=>R()==="upload"&&i()===null),h=e.derived(()=>t.label||t.i18n("audio.audio"));Qe(U,{get show_label(){return W()},get Icon(){return Ye},get float(){return e.get(c)},get label(){return e.get(h)}})}var z=e.sibling(U,2),Q=e.child(z);qe(Q,{get time_limit(){return B()}});var $=e.sibling(Q,2);{var je=c=>{var h=e.comment(),N=e.first_child(h);{var Y=T=>{var ee=bt(),J=e.first_child(ee);Re(J,{get i18n(){return t.i18n},onclear:ae});var oe=e.sibling(J,2);{var X=S=>{{let te=e.derived(()=>f()==="waiting");pt(S,{record:K,get recording(){return s()},stop:ce,get i18n(){return t.i18n},get waveform_settings(){return t.waveform_settings},get waveform_options(){return u()},get waiting(){return e.get(te)}})}},Z=S=>{ut(S,{get i18n(){return t.i18n},get editable(){return C()},get recording(){return s()},dispatch_blob:p,get waveform_settings(){return t.waveform_settings},get waveform_options(){return u()},get handle_reset_value(){return D()},onstartrecording:()=>t.onstart_recording?.(),onpauserecording:()=>t.onpause_recording?.(),onstoprecording:()=>t.onstop_recording?.(),get mode(){return e.get(x)},set mode(te){e.set(x,te,!0)}})};e.if(oe,S=>{n()?S(X):S(Z,!1)})}e.append(T,ee)},ie=T=>{var ee=e.comment(),J=e.first_child(ee);{var oe=X=>{{let Z=e.derived(()=>t.i18n("audio.drop_to_upload"));Ne(X,{filetype:"audio/aac,audio/midi,audio/mpeg,audio/ogg,audio/wav,audio/x-wav,audio/opus,audio/webm,audio/flac,audio/vnd.rn-realaudio,audio/x-ms-wma,audio/x-aiff,audio/amr,audio/*",onload:ve,onerror:S=>t.onerror?.(S),get root(){return t.root},get max_file_size(){return I()},get upload(){return t.upload},get stream_handler(){return t.stream_handler},get aria_label(){return e.get(Z)},get upload_promise(){return A()},set upload_promise(S){A(S)},get dragging(){return m()},set dragging(S){m(S)},get uploading(){return L()},set uploading(S){L(S)},children:(S,te)=>{var _e=e.comment(),ne=e.first_child(_e);{var ge=se=>{var me=e.comment(),pe=e.first_child(me);e.snippet(pe,()=>t.children),e.append(se,me)};e.if(ne,se=>{t.children&&se(ge)})}e.append(S,_e)},$$slots:{default:!0}})}};e.if(J,X=>{R()==="upload"&&X(oe)},!0)}e.append(T,ee)};e.if(N,T=>{R()==="microphone"?T(Y):T(ie,!1)})}e.append(c,h)},Ce=c=>{var h=wt(),N=e.first_child(h);{let ie=e.derived(()=>r()===null||r().some(T=>typeof T=="string"&&T==="download")?i().url:null);Re(N,{get i18n(){return t.i18n},onclear:ae,onedit:()=>{e.set(x,"edit"),t.onedit?.()},get download(){return e.get(ie)},children:(T,ee)=>{var J=e.comment(),oe=e.first_child(J);{var X=Z=>{var S=e.comment(),te=e.first_child(S);e.each(te,17,r,e.index,(_e,ne)=>{var ge=e.comment(),se=e.first_child(ge);{var me=re=>{var fe=e.comment(),Le=e.first_child(fe);{var Ue=he=>{$e(he,{get i18n(){return t.i18n},get onerror(){return t.onerror},onshare:()=>{},formatter:async be=>!be||!be.url?"":`<audio controls src="${await Te(be.url)}"></audio>`,get value(){return i()}})};e.if(Le,he=>{e.get(ne)==="share"&&he(Ue)})}e.append(re,fe)},pe=re=>{Xe(re,{get button(){return e.get(ne)},on_click:fe=>{b()&&b()(fe)}})};e.if(se,re=>{typeof e.get(ne)=="string"?re(me):re(pe,!1)})}e.append(_e,ge)}),e.append(Z,S)};e.if(oe,Z=>{i()!==null&&r()&&Z(X)})}e.append(T,J)},$$slots:{default:!0}})}var Y=e.sibling(N,2);{let ie=e.derived(()=>Array.isArray(g())?g():g()?.url);Ge(Y,{get value(){return i()},get subtitles(){return e.get(ie)},get label(){return t.label},get i18n(){return t.i18n},dispatch_blob:p,get waveform_settings(){return t.waveform_settings},get waveform_options(){return u()},get trim_region_settings(){return y()},get handle_reset_value(){return D()},get editable(){return C()},get loop(){return t.loop},interactive:!0,get onstop(){return t.onstop},get onplay(){return t.onplay},get onpause(){return t.onpause},get onedit(){return t.onedit},get mode(){return e.get(x)},set mode(T){e.set(x,T,!0)},get playback_position(){return w()},set playback_position(T){w(T)}})}e.append(c,h)};e.if($,c=>{i()==null||n()?c(je):c(Ce,!1)})}var Ie=e.sibling($,2);Je(Ie,{get sources(){return l()},handle_clear:ae,get active_source(){return R()},set active_source(c){R(c)}}),e.reset(z),e.template_effect(()=>{e.set_class(z,1,`audio-container ${k()??""}`,"svelte-ocxd3m"),e.set_attribute(z,"data-testid",t.label?"waveform-"+t.label:"unlabelled-audio")}),e.append(q,ue),e.pop()}var kt=e.from_html("<!> <!>",1),Rt=e.from_html("<!> <!>",1);function tr(q,t){e.push(t,!0);let i=e.rest_props(t,["$$slots","$$events","$$legacy"]),g=e.state(void 0);t.props.stream_every=.1;class W extends We{async get_data(){return e.get(g)&&(await e.get(g),await ze()),await super.get_data()}}const r=new W(i);let b=e.derived(()=>r.shared.label||r.i18n("audio.audio")),l=e.derived(()=>t.minimal??r.props.minimal??!1),a=e.derived(()=>r.props.sources?r.props.sources[0]:null),n=e.state(e.proxy(r.props.value));const y=()=>{e.get(n)===null||r.props.value===e.get(n)||(r.props.value=e.get(n))};let u=e.state(!1),m=e.state(e.proxy(r.props.recording??!1));e.user_effect(()=>{r.props.recording=e.get(m)});let R="darkorange",D=e.proxy({height:50,barWidth:2,barGap:3,cursorWidth:2,cursorColor:"#ddd5e9",autoplay:r.props.autoplay,barRadius:10,dragToSeek:!0,normalize:!0,minPxPerSec:20,waveColor:r.props.waveform_options.waveform_color||"#9ca3af",progressColor:r.props.waveform_options.waveform_progress_color||R,mediaControls:r.props.waveform_options.show_controls??!1,sampleRate:r.props.waveform_options.sample_rate||44100});const C={color:r.props.waveform_options.trim_region_color,drag:!0,resize:!0};function I(){document.documentElement.style.setProperty("--trim-region-color",C.color||R)}function j(w){const[B,f]=w.includes("Invalid file type")?["warning","complete"]:["error","error"];r.shared.loading_status&&(r.shared.loading_status.status=f,r.shared.loading_status.message=w),r.dispatch(B,w)}let L=e.state(e.proxy(r.props.value));e.user_effect(()=>{e.get(L)!=r.props.value&&(e.set(L,r.props.value,!0),r.dispatch("change"))}),de(()=>{I()});var s=e.comment(),k=e.first_child(s);{var A=w=>{{let B=e.derived(()=>e.get(u)?"focus":"base");Pe(w,{variant:"solid",get border_mode(){return e.get(B)},padding:!1,allow_overflow:!1,get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get visible(){return r.shared.visible},get container(){return r.shared.container},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},children:(f,v)=>{var x=kt(),E=e.first_child(x);ke(E,e.spread_props({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{on_clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}));var M=e.sibling(E,2);{let _=e.derived(()=>r.props.buttons??["download","share"]);He(M,{get i18n(){return r.i18n},get show_label(){return r.shared.show_label},get buttons(){return e.get(_)},get value(){return r.props.value},get subtitles(){return r.props.subtitles},get label(){return e.get(b)},get loop(){return r.props.loop},get waveform_settings(){return D},get waveform_options(){return r.props.waveform_options},get editable(){return r.props.editable},get minimal(){return e.get(l)},on_custom_button_click:P=>{r.dispatch("custom_button_click",{id:P})},onshare:P=>r.dispatch("share",P),onerror:P=>r.dispatch("error",P.detail),onplay:()=>r.dispatch("play"),onpause:()=>r.dispatch("pause"),onstop:()=>r.dispatch("stop"),get playback_position(){return r.props.playback_position},set playback_position(P){r.props.playback_position=P}})}e.append(f,x)},$$slots:{default:!0}})}},O=w=>{{let B=e.derived(()=>r.props.value===null&&e.get(a)==="upload"?"dashed":"solid"),f=e.derived(()=>e.get(u)?"focus":"base");Pe(w,{get variant(){return e.get(B)},get border_mode(){return e.get(f)},padding:!1,allow_overflow:!1,get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get visible(){return r.shared.visible},get container(){return r.shared.container},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},children:(v,x)=>{var E=Rt(),M=e.first_child(E);ke(M,e.spread_props({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{on_clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}));var _=e.sibling(M,2);{let P=e.derived(()=>r.props.buttons??[]),G=e.derived(()=>e.get(a)||void 0);xt(_,{get label(){return e.get(b)},get show_label(){return r.shared.show_label},get buttons(){return e.get(P)},on_custom_button_click:d=>{r.dispatch("custom_button_click",{id:d})},get value(){return r.props.value},get subtitles(){return r.props.subtitles},onchange:d=>r.props.value=d,onstream:d=>{r.props.value=d,r.dispatch("stream",r.props.value)},ondrag:d=>e.set(u,d,!0),get root(){return r.shared.root},get sources(){return r.props.sources},get active_source(){return e.get(G)},get pending(){return r.shared.loading_status.pending},get streaming(){return r.props.streaming},get loop(){return r.props.loop},get max_file_size(){return r.shared.max_file_size},handle_reset_value:y,get editable(){return r.props.editable},onedit:()=>r.dispatch("edit"),onplay:()=>r.dispatch("play"),onpause:()=>r.dispatch("pause"),onstop:()=>r.dispatch("stop"),onstart_recording:()=>r.dispatch("start_recording"),onpause_recording:()=>r.dispatch("pause_recording"),onstop_recording:()=>{r.dispatch("stop_recording"),r.dispatch("input")},onupload:()=>{r.dispatch("upload"),r.dispatch("input")},onclear:()=>{r.dispatch("clear"),r.dispatch("input")},onerror:j,onclose_stream:()=>r.dispatch("close_stream","stream"),get i18n(){return r.i18n},get waveform_settings(){return D},get waveform_options(){return r.props.waveform_options},get trim_region_settings(){return C},get stream_every(){return r.props.stream_every},get stream_state(){return r.shared.loading_status.stream_state},upload:(...d)=>r.shared.client.upload(...d),stream_handler:(...d)=>r.shared.client.stream(...d),get time_limit(){return r.shared.loading_status.time_limit},get upload_promise(){return e.get(g)},set upload_promise(d){e.set(g,d,!0)},get initial_value(){return e.get(n)},set initial_value(d){e.set(n,d,!0)},get recording(){return e.get(m)},set recording(d){e.set(m,d,!0)},get dragging(){return e.get(u)},set dragging(d){e.set(u,d,!0)},get playback_position(){return r.props.playback_position},set playback_position(d){r.props.playback_position=d},children:(d,F)=>{Ze(d,{get i18n(){return r.i18n},type:"audio"})},$$slots:{default:!0}})}e.append(v,E)},$$slots:{default:!0}})}};e.if(k,w=>{r.shared.interactive?w(O,!1):w(A)})}e.append(q,s),e.pop()}export{ir as BaseExample,xt as BaseInteractiveAudio,Ge as BasePlayer,He as BaseStaticAudio,tr as default};
