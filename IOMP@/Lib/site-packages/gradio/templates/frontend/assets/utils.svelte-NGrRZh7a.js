import*as i from"./svelte/svelte_internal_client.js";import{getContext as _,untrack as f}from"./svelte/svelte_svelte.js";import{$ as u}from"./i18n-IeFj-zpk.js";const l="__i18n__",y=["label","info","placeholder","description","title","value"],m="GRADIO_ROOT";class h extends Error{constructor(t){super(t),this.name="ShareError"}}async function O(s,t){if(window.__gradio_space__==null)throw new h("Must be on Spaces to share.");let r,o,n;{let c;if(typeof s=="object"&&s.url)c=s.url;else if(typeof s=="string")c=s;else throw new Error("Invalid data format for URL type");const p=await fetch(c);r=await p.blob(),o=p.headers.get("content-type")||"",n=p.headers.get("content-disposition")||""}const e=new File([r],n,{type:o}),a=await fetch("https://huggingface.co/uploads",{method:"POST",body:e,headers:{"Content-Type":e.type,"X-Requested-With":"XMLHttpRequest"}});if(!a.ok){if(a.headers.get("content-type")?.includes("application/json")){const c=await a.json();throw new h(`Upload failed: ${c.error}`)}throw new h("Upload failed.")}return await a.text()}function T(s){s.addEventListener("click",t);async function t(r){const o=r.composedPath(),[n]=o.filter(e=>e?.tagName==="BUTTON"&&e.classList.contains("copy_code_button"));if(n){let e=function(p){p.style.opacity="1",setTimeout(()=>{p.style.opacity="0"},2e3)};r.stopImmediatePropagation();const a=n.parentElement.innerText.trim(),d=Array.from(n.children)[1];await g(a)&&e(d)}}return{destroy(){s.removeEventListener("click",t)}}}async function g(s){let t=!1;if("clipboard"in navigator)await navigator.clipboard.writeText(s),t=!0;else{const r=document.createElement("textarea");r.value=s,r.style.position="absolute",r.style.left="-999999px",document.body.prepend(r),r.select();try{document.execCommand("copy"),t=!0}catch(o){console.error(o),t=!1}finally{r.remove()}}return t}const R=s=>{const t=Math.floor(s/3600),r=Math.floor(s%3600/60),o=Math.round(s)%60,n=`${r<10?"0":""}${r}`,e=`${o<10?"0":""}${o}`;return t>0?`${t}:${n}:${e}`:`${r}:${e}`},b=typeof window<"u",w=["elem_id","elem_classes","visible","interactive","server_fns","server","id","target","theme_mode","version","root","autoscroll","max_file_size","formatter","client","load_component","scale","min_width","theme","padding","loading_status","label","show_label","validation_error","show_progress","api_prefix","container","attached_events"];function k(s){return typeof s=="string"&&s.includes(l)}function E(s,t){const r=s.indexOf(l);if(r===-1)return s;const o=r+l.length,n=s.indexOf("}",o)+1;if(n===0)return s;try{const e=JSON.parse(s.slice(o,n));if(e?.key){const a=t(e.key),d=a!==e.key?a:e.key;return s.slice(0,r)+d+s.slice(n)}}catch{}return s}class S{load_component;#t=i.state(i.proxy({}));get shared(){return i.get(this.#t)}set shared(t){i.set(this.#t,t,!0)}#e=i.state(i.proxy({}));get props(){return i.get(this.#e)}set props(t){i.set(this.#e,t,!0)}#s=i.state(t=>t);get i18n(){return i.get(this.#s)}set i18n(t){i.set(this.#s,t,!0)}translatable_props={};dispatcher;last_update=null;shared_props=w;constructor(t,r){for(const e in t.shared_props)this.shared[e]=t.shared_props[e];for(const e in t.props)this.props[e]=t.props[e];if(r)for(const e in r)this.props[e]===void 0&&(this.props[e]=r[e]);this.i18n=this.props.i18n??(e=>e);for(const e of y)this.shared[e]=this._translate_and_store("shared",e,t.shared_props[e]),this.props[e]=this._translate_and_store("props",e,t.props[e]);if(this.load_component=this.shared.load_component,!b||t.props?.__GRADIO_BROWSER_TEST__){this.dispatcher=()=>{};return}const{register:o,dispatcher:n}=_(m);o(t.shared_props.id,this.set_data.bind(this),this.get_data.bind(this)),this.dispatcher=n,i.user_effect(()=>{for(const e in t.shared_props)this._is_i18n_managed(`shared.${e}`,t.shared_props[e])||(this.shared[e]=t.shared_props[e]);for(const e in t.props)this._is_i18n_managed(`props.${e}`,t.props[e])||(this.props[e]=t.props[e]);o(t.shared_props.id,this.set_data.bind(this),this.get_data.bind(this)),f(()=>{this.shared.id=t.shared_props.id})}),Object.keys(this.translatable_props).length>0&&u.subscribe(()=>{for(const[e,a]of Object.entries(this.translatable_props)){const[d,c]=e.split("."),p=this.i18n(a);d==="shared"?this.shared[c]=p:this.props[c]=p}})}_is_i18n_managed(t,r){const o=this.translatable_props[t];return o?r===o?!0:(delete this.translatable_props[t],!1):!1}_translate_and_store(t,r,o){if(typeof o!="string")return o;const n=this.i18n(o);return n!==o&&(this.translatable_props[`${t}.${r}`]=o),n}dispatch(t,r){this.dispatcher(this.shared.id,t,r)}async get_data(){return i.snapshot(this.props)}update(t){this.set_data(t)}set_data(t){for(const r in t){const o=t[r],n=k(o)?this._translate_and_store(this.shared_props.includes(r)?"shared":"props",r,o):o;if(this.shared_props.includes(r)){const e=r;this.shared[e]=n;continue}this.props[r]=n}}}const A=s=>typeof s=="number"?s+"px":s;function j(s){if(!s)return!1;const t=s.scrollHeight>s.clientHeight,r=s.scrollTop>=s.scrollHeight-s.clientHeight-1;return t&&!r}export{S as G,l as I,h as S,w as a,T as b,A as c,m as d,R as f,j as s,E as t,O as u};
