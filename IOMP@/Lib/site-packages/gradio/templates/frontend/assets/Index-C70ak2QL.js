import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-IeFj-zpk.js";import{G as ee}from"./utils.svelte-NGrRZh7a.js";import{n as te,d as V,F as O,e as W,E as re,I as N,p as le,q as ae,B as ne,U as oe}from"./ScrollFade-YiJdnYV-.js";import"./svelte/svelte_internal_flags_legacy.js";import{tick as X}from"./svelte/svelte_svelte.js";import{U as Q}from"./ModifyUpload-p1twvKjm.js";import{S as se}from"./StreamingBar-CdRfiLdf.js";import{default as Ne}from"./Example-CPmG5Ezd.js";import"./svelte/svelte_store.js";import"./index-VELz1aW8.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./MarkdownCode-DtcflbAZ.js";import"./prism-python-BAjd7o3F.js";const ie=v=>{let t=["B","KB","MB","GB","PB"],a=0;for(;v>1024;)v/=1024,a++;let p=t[a];return v.toFixed(1)+"&nbsp;"+p};var ue=e.from_html('<span class="drag-handle svelte-al0bnp">⋮⋮</span>'),de=e.from_html("<!>&nbsp;&#8675;",1),ge=e.from_html('<td class="svelte-al0bnp"><button class="label-clear-button svelte-al0bnp" aria-label="Remove this file">×</button></td>'),_e=e.from_html('<tr><td class="filename svelte-al0bnp"><!> <span class="stem svelte-al0bnp"> </span> <span class="ext svelte-al0bnp"> </span></td><td class="download svelte-al0bnp"><!></td><!></tr>'),ce=e.from_html('<div class="file-preview-holder svelte-al0bnp"><table class="file-preview svelte-al0bnp"><tbody class="svelte-al0bnp"></tbody></table></div>');function Z(v,t){e.push(t,!0);let a=e.prop(t,"value",7),p=e.prop(t,"selectable",3,!1),h=e.prop(t,"height",3,void 0),w=e.prop(t,"allow_reordering",3,!1),r=e.state(null),_=e.state(null);function x(n,o){e.set(r,o,!0),n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",o.toString()))}function b(n,o){if(n.preventDefault(),o===e.get(g).length-1){const l=n.currentTarget.getBoundingClientRect(),s=l.top+l.height/2;e.set(_,n.clientY>s?e.get(g).length:o,!0)}else e.set(_,o,!0);n.dataTransfer&&(n.dataTransfer.dropEffect="move")}function z(n){(!n.dataTransfer?.dropEffect||n.dataTransfer.dropEffect==="none")&&(e.set(r,null),e.set(_,null))}function d(n,o){if(n.preventDefault(),e.get(r)===null||e.get(r)===o)return;const l=Array.isArray(a())?[...a()]:[a()],[s]=l.splice(e.get(r),1);l.splice(e.get(_)===e.get(g).length?e.get(g).length:o,0,s);const B=Array.isArray(a())?l:l[0];t.onchange?.(B),e.set(r,null),e.set(_,null)}function c(n){const o=n.lastIndexOf(".");return o===-1?[n,""]:[n.slice(0,o),n.slice(o)]}let g=e.derived(()=>(Array.isArray(a())?a():[a()]).map(n=>{const[o,l]=c(n.orig_name??"");return{...n,filename_stem:o,filename_ext:l}}));function T(n,o){const l=n.currentTarget;(n.target===l||l&&l.firstElementChild&&n.composedPath().includes(l.firstElementChild))&&t.onselect?.({value:e.get(g)[o].orig_name,index:o})}function E(n){const o=Array.isArray(a())?[...a()]:[a()],l=o.splice(n,1),s=Array.isArray(a())?o:o[0];a(s),t.ondelete?.(l[0]),t.onchange?.(s)}function A(n){t.ondownload?.(n)}const m=typeof window<"u";var f=ce();let i;var I=e.child(f),L=e.child(I);e.each(L,23,()=>e.get(g),n=>n.url,(n,o,l)=>{var s=_e();let B;s.__click=u=>{T(u,e.get(l))};var k=e.child(s),U=e.child(k);{var q=u=>{var y=ue();e.append(u,y)};e.if(U,u=>{w()&&e.get(g).length>1&&u(q)})}var R=e.sibling(U,2),Y=e.child(R,!0);e.reset(R);var C=e.sibling(R,2),K=e.child(C,!0);e.reset(C),e.reset(k);var G=e.sibling(k),F=e.child(G);{var S=u=>{{let y=e.derived(()=>m&&window.__is_colab__?null:e.get(o).orig_name);te(u,{get href(){return e.get(o).url},get download(){return e.get(y)},$$events:{click:()=>A(e.get(o))},children:(D,H)=>{var J=de(),$=e.first_child(J);e.html($,()=>e.get(o).size!=null?ie(e.get(o).size):"(size unknown)"),e.next(),e.append(D,J)},$$slots:{default:!0}})}},M=u=>{var y=e.text();e.template_effect(D=>e.set_text(y,D),[()=>t.i18n("file.uploading")]),e.append(u,y)};e.if(F,u=>{e.get(o).url?u(S):u(M,!1)})}e.reset(G);var j=e.sibling(G);{var P=u=>{var y=ge(),D=e.child(y);D.__click=()=>{E(e.get(l))},D.__keydown=H=>{H.key==="Enter"&&E(e.get(l))},e.reset(y),e.append(u,y)};e.if(j,u=>{e.get(g).length>1&&u(P)})}e.reset(s),e.template_effect(()=>{B=e.set_class(s,1,"file svelte-al0bnp",null,B,{selectable:p(),dragging:e.get(r)===e.get(l),"drop-target":e.get(_)===e.get(l)||e.get(l)===e.get(g).length-1&&e.get(_)===e.get(g).length}),e.set_attribute(s,"data-drop-target",e.get(_)===e.get(g).length&&e.get(l)===e.get(g).length-1||e.get(_)===e.get(l)+1?"after":"before"),e.set_attribute(s,"draggable",w()&&e.get(g).length>1),e.set_attribute(k,"aria-label",e.get(o).orig_name),e.set_text(Y,e.get(o).filename_stem),e.set_text(K,e.get(o).filename_ext)}),e.event("dragstart",s,u=>x(u,e.get(l))),e.event("dragenter",s,u=>u.preventDefault()),e.event("dragover",s,u=>b(u,e.get(l))),e.event("drop",s,u=>d(u,e.get(l))),e.event("dragend",s,z),e.append(n,s)}),e.reset(L),e.reset(I),e.reset(f),e.template_effect(()=>i=e.set_style(f,"",i,{"max-height":h()?typeof h()=="number"?h()+"px":h():"auto"})),e.append(v,f),e.pop()}e.delegate(["click","keydown"]);var fe=e.from_html("<!> <!> <!>",1);function he(v,t){e.push(t,!0);let a=e.prop(t,"buttons",3,null),p=e.prop(t,"on_custom_button_click",3,null);var h=fe(),w=e.first_child(h);{var r=d=>{W(d,{get buttons(){return a()},get on_custom_button_click(){return p()}})};e.if(w,d=>{t.show_label&&a()&&a().length>0&&d(r)})}var _=e.sibling(w,2);{let d=e.derived(()=>t.value===null),c=e.derived(()=>t.label||"File");V(_,{get show_label(){return t.show_label},get float(){return e.get(d)},get Icon(){return O},get label(){return e.get(c)}})}var x=e.sibling(_,2);{var b=d=>{Z(d,{get i18n(){return t.i18n},get selectable(){return t.selectable},get value(){return t.value},get height(){return t.height},$$events:{select(...c){t.on_select?.apply(this,c)},download(...c){t.on_download?.apply(this,c)}}})},z=d=>{re(d,{unpadded_box:!0,size:"large",children:(c,g)=>{O(c)},$$slots:{default:!0}})};e.if(x,d=>{t.value&&(!Array.isArray(t.value)||t.value.length>0)?d(b):d(z,!1)})}e.append(v,h),e.pop()}var pe=e.from_html("<!> <!>",1),me=e.from_html("<!> <!>",1),ve=e.from_html("<!> <!> <!>",1);function be(v,t){e.push(t,!0);let a=e.prop(t,"value",15),p=e.prop(t,"show_label",3,!0),h=e.prop(t,"file_count",3,"single"),w=e.prop(t,"file_types",3,null),r=e.prop(t,"selectable",3,!1),_=e.prop(t,"height",3,void 0),x=e.prop(t,"max_file_size",3,null),b=e.prop(t,"uploading",15,!1),z=e.prop(t,"allow_reordering",3,!1),d=e.prop(t,"upload_promise",15),c=e.prop(t,"buttons",3,null),g=e.prop(t,"on_custom_button_click",3,null);async function T(l){Array.isArray(a())?a([...a(),...Array.isArray(l)?l:[l]]):a()?a([a(),...Array.isArray(l)?l:[l]]):a(l),await X(),t.onchange?.(a()),t.onupload?.(a())}function E(){a(null),t.onchange?.(null),t.onclear?.()}let A=e.state(!1);var m=ve(),f=e.first_child(m);{var i=l=>{W(l,{get buttons(){return c()},get on_custom_button_click(){return g()}})};e.if(f,l=>{p()&&c()&&c().length>0&&l(i)})}var I=e.sibling(f,2);{let l=e.derived(()=>!a()),s=e.derived(()=>t.label||"File");V(I,{get show_label(){return p()},get Icon(){return O},get float(){return e.get(l)},get label(){return e.get(s)}})}var L=e.sibling(I,2);{var n=l=>{var s=me(),B=e.first_child(s);{let U=e.derived(()=>c()||[]);W(B,{get buttons(){return e.get(U)},get on_custom_button_click(){return g()},children:(q,R)=>{var Y=pe(),C=e.first_child(Y);{var K=F=>{{let S=e.derived(()=>t.i18n("common.upload"));N(F,{get Icon(){return ae},get label(){return e.get(S)},children:(M,j)=>{Q(M,{icon_upload:!0,onload:T,get filetype(){return w()},get file_count(){return h()},get max_file_size(){return x()},get root(){return t.root},get onerror(){return t.onerror},get stream_handler(){return t.stream_handler},get upload(){return t.upload},get upload_promise(){return d()},set upload_promise(P){d(P)},get dragging(){return e.get(A)},set dragging(P){e.set(A,P,!0)},get uploading(){return b()},set uploading(P){b(P)}})},$$slots:{default:!0}})}};e.if(C,F=>{h()==="single"&&(Array.isArray(a())?a().length>0:a()!==null)||F(K)})}var G=e.sibling(C,2);{let F=e.derived(()=>t.i18n("common.clear"));N(G,{get Icon(){return le},get label(){return e.get(F)},onclick:S=>{S.stopPropagation(),E()}})}e.append(q,Y)},$$slots:{default:!0}})}var k=e.sibling(B,2);Z(k,{get i18n(){return t.i18n},get onselect(){return t.onselect},get selectable(){return r()},get value(){return a()},get height(){return _()},get onchange(){return t.onchange},get ondelete(){return t.ondelete},get allow_reordering(){return z()}}),e.append(l,s)},o=l=>{Q(l,{onload:T,get filetype(){return w()},get file_count(){return h()},get max_file_size(){return x()},get root(){return t.root},get onerror(){return t.onerror},get stream_handler(){return t.stream_handler},get upload(){return t.upload},get height(){return _()},get upload_promise(){return d()},set upload_promise(s){d(s)},get dragging(){return e.get(A)},set dragging(s){e.set(A,s,!0)},get uploading(){return b()},set uploading(s){b(s)},children:(s,B)=>{var k=e.comment(),U=e.first_child(k);e.slot(U,t,"default",{},null),e.append(s,k)},$$slots:{default:!0}})};e.if(L,l=>{a()&&(!Array.isArray(a())||a().length>0)?l(n):l(o,!1)})}e.append(v,m),e.pop()}var we=e.from_html("<!> <!>",1);function je(v,t){e.push(t,!0);const a=e.rest_props(t,["$$slots","$$events","$$legacy"]);let p=e.state(null),h=e.state(!1);class w extends ee{async get_data(){return e.get(p)&&(await e.get(p),await X()),await super.get_data()}}const r=new w(a);let _=e.state(e.proxy(r.props.value));e.user_effect(()=>{e.get(_)!==r.props.value&&(e.set(_,r.props.value,!0),r.dispatch("change",e.snapshot(r.props.value)))});{let x=e.derived(()=>r.props.value?"solid":"dashed"),b=e.derived(()=>e.get(h)?"focus":"base");ne(v,{get visible(){return r.shared.visible},get variant(){return e.get(x)},get border_mode(){return e.get(b)},padding:!1,get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get container(){return r.shared.container},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},allow_overflow:!1,children:(z,d)=>{var c=we(),g=e.first_child(c);{let m=e.derived(()=>r.shared.loading_status?.status||"complete");se(g,e.spread_props({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{get status(){return e.get(m)},on_clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}))}var T=e.sibling(g,2);{var E=m=>{he(m,{on_select:({detail:f})=>r.dispatch("select",f),on_download:({detail:f})=>r.dispatch("download",f),get selectable(){return r.props._selectable},get value(){return r.props.value},get label(){return r.shared.label},get show_label(){return r.shared.show_label},get height(){return r.props.height},get i18n(){return r.i18n},get buttons(){return r.props.buttons},on_custom_button_click:f=>{r.dispatch("custom_button_click",{id:f})}})},A=m=>{{let f=e.derived(()=>r.props.height??void 0);be(m,{upload:(...i)=>r.shared.client.upload(...i),stream_handler:(...i)=>r.shared.client.stream(...i),get label(){return r.shared.label},get show_label(){return r.shared.show_label},get value(){return r.props.value},get file_count(){return r.props.file_count},get file_types(){return r.props.file_types},get selectable(){return r.props._selectable},get height(){return e.get(f)},get root(){return r.shared.root},get allow_reordering(){return r.props.allow_reordering},get max_file_size(){return r.shared.max_file_size},get buttons(){return r.props.buttons},on_custom_button_click:i=>{r.dispatch("custom_button_click",{id:i})},onchange:i=>{r.props.value=i},ondrag:i=>e.set(h,i,!0),onclear:()=>r.dispatch("clear"),onselect:i=>r.dispatch("select",i),onupload:()=>r.dispatch("upload"),onerror:i=>{r.shared.loading_status=r.shared.loading_status||{},r.shared.loading_status.status="error",r.dispatch("error",i)},ondelete:i=>{r.dispatch("delete",i)},get i18n(){return r.i18n},get upload_promise(){return e.get(p)},set upload_promise(i){e.set(p,i,!0)},children:(i,I)=>{oe(i,{get i18n(){return r.i18n},type:"file"})},$$slots:{default:!0}})}};e.if(T,m=>{r.shared.interactive?m(A,!1):m(E)})}e.append(z,c)},$$slots:{default:!0}})}e.pop()}export{Ne as BaseExample,he as BaseFile,be as BaseFileUpload,Z as FilePreview,je as default};
