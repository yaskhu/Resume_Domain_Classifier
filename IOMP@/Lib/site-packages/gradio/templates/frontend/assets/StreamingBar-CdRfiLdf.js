import"./svelte/svelte_internal_flags_async.js";import{untrack as je,tick as Re}from"./svelte/svelte_svelte.js";import*as e from"./svelte/svelte_internal_client.js";import{spring as Le}from"./svelte/svelte_motion.js";import{I as Te,p as qe,a1 as Ue,a2 as He,a3 as We,a4 as Ge,a5 as Oe}from"./ScrollFade-YiJdnYV-.js";import"./svelte/svelte_internal_flags_legacy.js";import"./i18n-IeFj-zpk.js";import{A as Je}from"./MarkdownCode-DtcflbAZ.js";import{fade as Ae,slide as Ke}from"./svelte/svelte_transition.js";function we(i){let t=["","k","M","G","T","P","E","Z"],a=0;for(;i>1e3&&a<t.length-1;)i/=1e3,a++;let n=t[a];return(Number.isInteger(i)?i:i.toFixed(1))+n}var Qe=e.from_html('<div><svg viewBox="-1200 -1200 3000 3000" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-1vhirvf"><g><path d="M255.926 0.754768L509.702 139.936V221.027L255.926 81.8465V0.754768Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M509.69 139.936L254.981 279.641V361.255L509.69 221.55V139.936Z" fill="#FF7C00" class="svelte-1vhirvf"></path><path d="M0.250138 139.937L254.981 279.641V361.255L0.250138 221.55V139.937Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M255.923 0.232622L0.236328 139.936V221.55L255.923 81.8469V0.232622Z" fill="#FF7C00" class="svelte-1vhirvf"></path></g><g><path d="M255.926 141.5L509.702 280.681V361.773L255.926 222.592V141.5Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M509.69 280.679L254.981 420.384V501.998L509.69 362.293V280.679Z" fill="#FF7C00" class="svelte-1vhirvf"></path><path d="M0.250138 280.681L254.981 420.386V502L0.250138 362.295V280.681Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M255.923 140.977L0.236328 280.68V362.294L255.923 222.591V140.977Z" fill="#FF7C00" class="svelte-1vhirvf"></path></g></svg></div>');function $e(i,t){e.push(t,!0);const a=()=>e.store_get(o,"$top",p),n=()=>e.store_get(g,"$bottom",p),[p,_]=e.setup_stores();let b=e.prop(t,"margin",3,!0);const o=Le([0,0]),g=Le([0,0]);let R=e.state(!1);async function I(){await Promise.all([o.set([125,140]),g.set([-125,-140])]),await Promise.all([o.set([-125,140]),g.set([125,-140])]),await Promise.all([o.set([-125,0]),g.set([125,-0])]),await Promise.all([o.set([125,0]),g.set([-125,0])])}async function C(){await I(),e.get(R)||C()}async function L(){await Promise.all([o.set([125,0]),g.set([-125,0])]),C()}e.user_effect(()=>(L(),()=>{e.set(R,!0)}));var s=Qe();let y;var j=e.child(s),T=e.child(j),z=e.sibling(T);e.reset(j),e.reset(s),e.template_effect(()=>{y=e.set_class(s,1,"svelte-1vhirvf",null,y,{margin:b()}),e.set_style(T,`transform: translate(${a()[0]??""}px, ${a()[1]??""}px);`),e.set_style(z,`transform: translate(${n()[0]??""}px, ${n()[1]??""}px);`)}),e.append(i,s),e.pop(),_()}let ge=[],Fe=!1;const et=typeof window<"u",Ie=et?window.requestAnimationFrame:i=>{};async function tt(i,t=!0){if(!(window.__gradio_mode__==="website"||window.__gradio_mode__!=="app"&&t!==!0)){if(ge.push(i),!Fe)Fe=!0;else return;await Re(),Ie(()=>{let a=[0,0];for(let n=0;n<ge.length;n++){const _=ge[n].getBoundingClientRect();(n===0||_.top+window.scrollY<=a[0])&&(a[0]=_.top+window.scrollY,a[1]=n)}window.scrollTo({top:a[0]-20,behavior:"smooth"}),Fe=!1,ge=[]})}}var at=e.from_html('<div class="validation-error svelte-1uj8rng"> <button class="svelte-1uj8rng"><!></button></div>'),rt=e.from_html('<div class="eta-bar svelte-1uj8rng"></div>'),st=e.from_html("<!> ",1),lt=e.from_html("<!> <!> <!> <!>",1),it=e.from_html('<div class="progress-level svelte-1uj8rng"><div class="progress-level-inner svelte-1uj8rng"><!></div> <div class="progress-bar-wrap svelte-1uj8rng"><div class="progress-bar svelte-1uj8rng"></div></div></div>'),nt=e.from_html('<p class="loading svelte-1uj8rng"> </p> <!>',1),ot=e.from_html("<!> <div><!> <!></div> <!> <!>",1),dt=e.from_html('<div class="clear-status svelte-1uj8rng"><!></div> <span class="error svelte-1uj8rng"> </span> <!>',1),vt=e.from_html('<div data-testid="status-tracker"><!> <!></div>');function qt(i,t){e.push(t,!0);let a=e.prop(t,"eta",7,null),n=e.prop(t,"scroll_to_output",3,!1),p=e.prop(t,"timer",3,!0),_=e.prop(t,"show_progress",3,"full"),b=e.prop(t,"message",3,null),o=e.prop(t,"progress",3,null),g=e.prop(t,"variant",3,"default"),R=e.prop(t,"loading_text",3,"Loading..."),I=e.prop(t,"absolute",3,!0),C=e.prop(t,"translucent",3,!1),L=e.prop(t,"border",3,!1),s=e.prop(t,"validation_error",7,null),y=e.prop(t,"show_validation_error",3,!0),j=e.prop(t,"type",3,null),T,z=!1,se=e.state(0),G=e.state(null),h=e.state(null),U=e.state(!1),E=e.state(null);const me=e.derived(()=>j()==="input"||!t.status||t.status==="complete"||_()==="hidden"||t.status=="streaming"||!!(y()&&s()));let Q=e.state(0);const pe=e.derived(()=>e.get(h)===null||e.get(h)<=0||!e.get(Q)?0:Math.min(e.get(Q)/e.get(h),1)),le=e.derived(()=>e.get(Q).toFixed(1));let $=e.derived(()=>o()==null);function ie(){Ie(()=>{e.set(Q,(performance.now()-e.get(se))/1e3),z&&ie()})}let A=e.derived(()=>{let l=null;o()!=null?l=o().map(v=>{if(v.index!=null&&v.length!=null)return v.index/v.length;if(v.progress!=null)return v.progress}):l=null;let f,x="";return l?(f=l[l.length-1],f===0?x="0":x="150ms"):f=void 0,{progress_level:l,last_progress_level:f,progress_bar_transition:x}});function he(){z||(e.set(G,e.set(E,null),!0),e.set(se,performance.now(),!0),z=!0,ie())}function ne(){e.set(G,e.set(E,null),!0),z&&(z=!1)}e.user_effect(()=>{t.status==="pending"?he():je(()=>{ne()})}),e.user_effect(()=>{T&&n()&&(t.status==="pending"||t.status==="complete")&&tt(T,t.autoscroll)}),e.user_effect(()=>{a()===null&&a(e.get(G)),a()!=null&&e.get(G)!==a()&&(e.set(h,(performance.now()-e.get(se))/1e3+a()),e.set(E,e.get(h).toFixed(1),!0),e.set(G,a(),!0))});function ce(){e.set(U,!1)}e.user_effect(()=>{je(()=>{ce()}),t.status==="error"&&b()&&e.set(U,!0)});var H=vt();let oe,de;var ue=e.child(H);{var xe=l=>{var f=at(),x=e.child(f),v=e.sibling(x),m=e.child(v);{let q=e.derived(()=>t.i18n?t.i18n("common.clear"):"Clear");Te(m,{get Icon(){return qe},get label(){return e.get(q)},disabled:!1,size:"x-small",background:"var(--background-fill-primary)",color:"var(--error-background-text)",border:"var(--border-color-primary)",onclick:()=>s(null)})}e.reset(v),e.reset(f),e.template_effect(()=>e.set_text(x,`${s()??""} `)),e.append(l,f)};e.if(ue,l=>{s()&&y()&&l(xe)})}var be=e.sibling(ue,2);{var r=l=>{var f=ot(),x=e.first_child(f);{var v=d=>{var c=rt();let w;e.template_effect(()=>w=e.set_style(c,"",w,{transform:`translateX(${(e.get(pe)||0)*100-100}%)`})),e.append(d,c)};e.if(x,d=>{g()==="default"&&e.get($)&&_()==="full"&&d(v)})}var m=e.sibling(x,2);let q;var P=e.child(m);{var O=d=>{var c=e.comment(),w=e.first_child(c);e.each(w,17,o,e.index,(S,F)=>{var V=e.comment(),B=e.first_child(V);{var ee=X=>{var Y=st(),te=e.first_child(Y);{var ye=D=>{var K=e.text();e.template_effect((fe,_e)=>e.set_text(K,`${fe??""}/${_e??""}`),[()=>we(e.get(F).index||0),()=>we(e.get(F).length)]),e.append(D,K)},ae=D=>{var K=e.text();e.template_effect(fe=>e.set_text(K,fe),[()=>we(e.get(F).index||0)]),e.append(D,K)};e.if(te,D=>{e.get(F).length!=null?D(ye):D(ae,!1)})}var re=e.sibling(te);e.template_effect(()=>e.set_text(re,` ${e.get(F).unit??""} |  `)),e.append(X,Y)};e.if(B,X=>{e.get(F).index!=null&&X(ee)})}e.append(S,V)}),e.append(d,c)},k=d=>{var c=e.comment(),w=e.first_child(c);{var S=V=>{var B=e.text();e.template_effect(()=>e.set_text(B,`queue: ${t.queue_position+1}/${t.queue_size??""} |`)),e.append(V,B)},F=V=>{var B=e.comment(),ee=e.first_child(B);{var X=Y=>{var te=e.text("processing |");e.append(Y,te)};e.if(ee,Y=>{t.queue_position===0&&Y(X)},!0)}e.append(V,B)};e.if(w,V=>{t.queue_position!==null&&t.queue_size!==void 0&&t.queue_position>=0?V(S):V(F,!1)},!0)}e.append(d,c)};e.if(P,d=>{o()?d(O):d(k,!1)})}var Z=e.sibling(P,2);{var J=d=>{var c=e.text();e.template_effect(()=>e.set_text(c,`${e.get(le)??""}${a()?`/${e.get(E)}`:""}s`)),e.append(d,c)};e.if(Z,d=>{p()&&d(J)})}e.reset(m);var W=e.sibling(m,2);{var ve=d=>{var c=it(),w=e.child(c),S=e.child(w);{var F=X=>{var Y=e.comment(),te=e.first_child(Y);e.each(te,17,o,e.index,(ye,ae,re)=>{var D=e.comment(),K=e.first_child(D);{var fe=_e=>{var Me=lt(),ke=e.first_child(Me);{var Se=M=>{var N=e.text("Â /");e.append(M,N)};e.if(ke,M=>{re!==0&&M(Se)})}var Ve=e.sibling(ke,2);{var Be=M=>{var N=e.text();e.template_effect(()=>e.set_text(N,e.get(ae).desc)),e.append(M,N)};e.if(Ve,M=>{e.get(ae).desc!=null&&M(Be)})}var Ce=e.sibling(Ve,2);{var Xe=M=>{var N=e.text("-");e.append(M,N)};e.if(Ce,M=>{e.get(ae).desc!=null&&e.get(A).progress_level&&e.get(A).progress_level[re]!=null&&M(Xe)})}var Ye=e.sibling(Ce,2);{var De=M=>{var N=e.text();e.template_effect(Ne=>e.set_text(N,`${Ne??""}%`),[()=>(100*(e.get(A).progress_level[re]||0)).toFixed(1)]),e.append(M,N)};e.if(Ye,M=>{e.get(A).progress_level!=null&&M(De)})}e.append(_e,Me)};e.if(K,_e=>{(e.get(ae).desc!=null||e.get(A).progress_level&&e.get(A).progress_level[re]!=null)&&_e(fe)})}e.append(ye,D)}),e.append(X,Y)};e.if(S,X=>{o()!=null&&X(F)})}e.reset(w);var V=e.sibling(w,2),B=e.child(V);let ee;e.reset(V),e.reset(c),e.template_effect(()=>ee=e.set_style(B,"",ee,{width:`${e.get(A).last_progress_level*100}%`,transition:e.get(A).progress_bar_transition})),e.append(d,c)},Ze=d=>{var c=e.comment(),w=e.first_child(c);{var S=F=>{{let V=e.derived(()=>g()==="default");$e(F,{get margin(){return e.get(V)}})}};e.if(w,F=>{_()==="full"&&F(S)},!0)}e.append(d,c)};e.if(W,d=>{e.get(A).last_progress_level!=null?d(ve):d(Ze,!1)})}var ze=e.sibling(W,2);{var Ee=d=>{var c=nt(),w=e.first_child(c),S=e.child(w,!0);e.reset(w);var F=e.sibling(w,2);e.slot(F,t,"additional-loading-text",{},null),e.template_effect(()=>e.set_text(S,R())),e.append(d,c)};e.if(ze,d=>{p()||d(Ee)})}e.template_effect(()=>q=e.set_class(m,1,"progress-text svelte-1uj8rng",null,q,{"meta-text-center":g()==="center","meta-text":g()==="default"})),e.append(l,f)},u=l=>{var f=e.comment(),x=e.first_child(f);{var v=m=>{var q=dt(),P=e.first_child(q),O=e.child(P);{let W=e.derived(()=>t.i18n("common.clear"));Te(O,{get Icon(){return qe},get label(){return e.get(W)},disabled:!1,$$events:{click:()=>{t.on_clear_status?.()}}})}e.reset(P);var k=e.sibling(P,2),Z=e.child(k,!0);e.reset(k);var J=e.sibling(k,2);e.slot(J,t,"error",{},null),e.template_effect(W=>e.set_text(Z,W),[()=>t.i18n("common.error")]),e.append(m,q)};e.if(x,m=>{t.status==="error"&&m(v)},!0)}e.append(l,f)};e.if(be,l=>{t.status==="pending"?l(r):l(u,!1)})}e.reset(H),e.bind_this(H,l=>T=l,()=>T),e.template_effect(()=>{oe=e.set_class(H,1,`wrap ${g()??""} ${_()??""}`,"svelte-1uj8rng",oe,{"no-click":s()&&y(),hide:e.get(me),translucent:g()==="center"&&(t.status==="pending"||t.status==="error")||C()||_()==="minimal"||s(),generating:t.status==="generating"&&_()==="full",border:L()}),de=e.set_style(H,"",de,{position:I()?"absolute":"static",padding:I()?"0":"var(--size-8) 0"})}),e.append(i,H),e.pop()}const ft=(i,t=location.href)=>{try{return!!i&&new URL(i).origin!==new URL(t).origin}catch{return!1}};function _t(i){const t=new Je,a=new DOMParser().parseFromString(i,"text/html");return Pe(a.body,"A",n=>{n instanceof HTMLElement&&"target"in n&&ft(n.getAttribute("href"),location.href)&&(n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"))}),t.sanitize(a).body.innerHTML}function Pe(i,t,a){i&&(i.nodeName===t||typeof t=="function")&&a(i);const n=i?.childNodes||[];for(let p=0;p<n.length;p++)Pe(n[p],t,a)}var ct=e.from_html('<span class="toast-count svelte-irmu64"> </span>'),ut=e.from_html('<div class="toast-separator svelte-irmu64"></div>'),gt=e.from_html('<div><div data-testid="toast-text"><!></div></div> <!>',1),mt=e.from_html('<div class="toast-messages svelte-irmu64"></div>'),pt=e.from_html("<div></div>"),ht=e.from_html('<div role="status" aria-live="polite" data-testid="toast-body"><div class="toast-header svelte-irmu64" role="button" tabindex="0"><div><!></div> <div class="toast-title-row svelte-irmu64"><span> <!></span> <div><!></div></div> <button type="button" aria-label="Close" data-testid="toast-close"><span aria-hidden="true">&#215;</span></button></div> <!> <!></div>');function xt(i,t){e.push(t,!0);let a=e.prop(t,"messages",19,()=>[]),n=e.prop(t,"expanded",3,!0),p=e.state(0),_=e.state(0),b=e.state(0),o=e.state(!1),g;const R={error:"An error occurred.",warning:"Warning.",success:"Success.",info:"Info."};let I=e.derived(()=>a().length),C=e.derived(()=>a()[0]),L=e.derived(()=>t.type.charAt(0).toUpperCase()+t.type.slice(1)),s=e.derived(()=>e.get(C)?.duration!==null),y=e.derived(()=>e.get(s)?`${e.get(C).duration}s`:"0s");function j(){t.ontoggle?.()}function T(){a().forEach(r=>{t.onclose?.(r.id)})}function z(r){e.set(p,r.touches[0].clientX,!0),e.set(_,r.touches[0].clientY,!0),e.set(o,!0)}function se(r){if(!e.get(o))return;const u=r.touches[0].clientX,l=r.touches[0].clientY,f=u-e.get(p),x=l-e.get(_);Math.abs(f)>Math.abs(x)&&Math.abs(f)>10&&(r.preventDefault(),e.set(b,f))}function G(){e.get(o)&&(Math.abs(e.get(b))>100?T():e.set(b,0),e.set(o,!1))}e.user_effect(()=>{e.get(s)&&a().length===1&&setTimeout(T,e.get(C).duration*1e3)});var h=ht();h.__touchstart=z,h.__touchmove=se,h.__touchend=G;var U=e.child(h);U.__click=j,U.__keydown=r=>{(r.key==="Enter"||r.key===" ")&&j()};var E=e.child(U),me=e.child(E);{var Q=r=>{He(r)},pe=r=>{var u=e.comment(),l=e.first_child(u);{var f=v=>{We(v)},x=v=>{var m=e.comment(),q=e.first_child(m);{var P=k=>{Ge(k)},O=k=>{var Z=e.comment(),J=e.first_child(Z);{var W=ve=>{Oe(ve)};e.if(J,ve=>{t.type==="error"&&ve(W)},!0)}e.append(k,Z)};e.if(q,k=>{t.type==="success"?k(P):k(O,!1)},!0)}e.append(v,m)};e.if(l,v=>{t.type==="info"?v(f):v(x,!1)},!0)}e.append(r,u)};e.if(me,r=>{t.type==="warning"?r(Q):r(pe,!1)})}e.reset(E);var le=e.sibling(E,2),$=e.child(le),ie=e.child($),A=e.sibling(ie);{var he=r=>{var u=ct(),l=e.child(u);e.reset(u),e.template_effect(()=>e.set_text(l,`(${e.get(I)??""})`)),e.append(r,u)};e.if(A,r=>{e.get(I)>1&&r(he)})}e.reset($);var ne=e.sibling($,2);let ce;var H=e.child(ne);Ue(H),e.reset(ne),e.reset(le);var oe=e.sibling(le,2);oe.__click=r=>{r.stopPropagation(),T()},e.reset(U);var de=e.sibling(U,2);{var ue=r=>{var u=mt();e.each(u,23,a,l=>l.id,(l,f,x)=>{var v=gt(),m=e.first_child(v),q=e.child(m),P=e.child(q);e.html(P,()=>_t(e.get(f).message||R[t.type])),e.reset(q),e.reset(m);var O=e.sibling(m,2);{var k=Z=>{var J=ut();e.append(Z,J)};e.if(O,Z=>{e.get(x)<a().length-1&&Z(k)})}e.template_effect(()=>{e.set_class(m,1,`toast-message-item ${t.type??""}`,"svelte-irmu64"),e.set_class(q,1,`toast-message-text ${t.type??""}`,"svelte-irmu64")}),e.append(l,v)}),e.reset(u),e.transition(3,u,()=>Ke,()=>({duration:200})),e.append(r,u)};e.if(de,r=>{n()&&r(ue)})}var xe=e.sibling(de,2);{var be=r=>{var u=pt();e.template_effect(()=>{e.set_class(u,1,`timer ${t.type??""}`,"svelte-irmu64"),e.set_style(u,`animation-duration: ${e.get(y)??""}`)}),e.append(r,u)};e.if(xe,r=>{e.get(s)&&r(be)})}e.reset(h),e.bind_this(h,r=>g=r,()=>g),e.template_effect(r=>{e.set_class(h,1,`toast-body ${t.type??""}`,"svelte-irmu64"),e.set_style(h,`transform: translateX(${e.get(b)??""}px); opacity: ${r??""};`),e.set_class(E,1,`toast-icon ${t.type??""}`,"svelte-irmu64"),e.set_class($,1,`toast-title ${t.type??""}`,"svelte-irmu64"),e.set_text(ie,`${e.get(L)??""} `),ce=e.set_class(ne,1,"chevron svelte-irmu64",null,ce,{expanded:n(),visible:e.get(I)>0}),e.set_class(oe,1,`toast-close ${t.type??""}`,"svelte-irmu64")},[()=>1-Math.abs(e.get(b))/300]),e.transition(1,h,()=>Ae,()=>({duration:200,delay:100})),e.transition(2,h,()=>Ae,()=>({duration:200})),e.append(i,h),e.pop()}e.delegate(["touchstart","touchmove","touchend","click","keydown"]);var bt=e.from_html('<div class="toast-item svelte-1qhecvt"><!></div>'),yt=e.from_html('<div class="toast-wrap svelte-1qhecvt"></div>');function At(i,t){e.push(t,!0);const a=()=>e.store_get(b,"$top",n),[n,p]=e.setup_stores();let _=e.prop(t,"messages",19,()=>[]);const b=Le(0,{stiffness:.4,damping:.5});let o=e.state(e.proxy([]));e.user_effect(()=>{R(_())}),e.user_effect(()=>{e.set(o,g(_()),!0)});function g(L){const s=new Map;return L.forEach(y=>{const j=y.type;s.has(j)||s.set(j,{type:y.type,messages:[],expanded:!0}),s.get(j).messages.push(y)}),Array.from(s.values())}function R(L){L.length>0&&"parentIFrame"in window&&window.parentIFrame?.getPageInfo(s=>{s.scrollTop<s.offsetTop?b.set(0):b.set(s.scrollTop-s.offsetTop)})}function I(L){e.set(o,e.get(o).map(s=>s.type===L?{...s,expanded:!s.expanded}:s),!0)}var C=yt();e.each(C,21,()=>e.get(o),L=>L.type,(L,s)=>{var y=bt(),j=e.child(y);xt(j,{get type(){return e.get(s).type},get messages(){return e.get(s).messages},get expanded(){return e.get(s).expanded},ontoggle:()=>I(e.get(s).type),onclose:T=>t.on_close(T)}),e.reset(y),e.append(L,y)}),e.reset(C),e.template_effect(()=>e.set_style(C,`--toast-top: ${a()??""}px;`)),e.append(i,C),e.pop(),p()}var wt=e.from_html('<div class="streaming-bar svelte-1au5sp1"></div>');function It(i,t){var a=e.comment(),n=e.first_child(a);{var p=_=>{var b=wt();let o;e.template_effect(()=>o=e.set_style(b,"",o,{"animation-duration":`${t.time_limit??""}s`})),e.append(_,b)};e.if(n,_=>{t.time_limit&&_(p)})}e.append(i,a)}export{$e as L,qt as S,At as T,It as a};
